\documentclass{standalone}

\usepackage{tikz,tikz-3dplot,pgfplots,xcolor}
\usetikzlibrary{arrows.meta,calc}

\input{../../Include/formula.tex}

%\pgfplotsset{compat=1.18} 
\definecolor{gray0}{rgb}{0.98,0.98,0.98}
\definecolor{gray1}{rgb}{0.8,0.8,0.8}
\definecolor{gray2}{rgb}{0.7,0.7,0.7}

\begin{document}

  \begin{tikzpicture}[>=Latex]

    % \draw (-1,7) rectangle (18,-11);
    \draw[rounded corners=20pt,gray1,thick] (-1,7) rectangle (18,-1);
    \draw[rounded corners=20pt,gray1,thick] (-1,-2) rectangle (18,-11);
    \node[right] at (-1,7.5){\huge{\bf(a)} Primary plasticity - slip and twinning};
    \node[right] at (-1,-1.5){\huge{\bf(b)} Secondary plasticity - rotated slip systems in twins};

    \begin{scope}[shift={(10,0)}]
      \path[fill=gray0] (0,0) -- (5,0) -- (5,6) -- (0,6) -- cycle;
      \path[fill=gray1] (0,0) -- (5,0) --++ (79.4:5) -- (0,6) -- cycle;
      \foreach \x in {0,...,5}{
        \draw[gray2] (\x,0) -- (\x,6);
        \draw[gray2] (0,1.2*\x) -- (5,1.2*\x);
      }
      \foreach \x in {0,...,5}{
        \draw (\x,0) -- (\x,6-1.2*\x);
        \draw (0,1.2*\x) -- (5-\x,1.2*\x); 
        \draw (5-\x,1.2*\x) --++ (79.4:5-\x); 
        \draw (\x,6-1.2*\x) --++ (-10.4:6-1.2*\x);
      }
      \foreach \x in {1,...,5}{
        \draw[->,red,dashed,ultra thick] (\x,6) --++ (309.8:0.28*\x);
      }
      \path(0,6)--(5,0) coordinate[pos=-0.1](a) coordinate[pos=1.1](b) coordinate[pos=0.9](c);
      \draw[dashed,thick](a) -- (b);
      \draw[ultra thick,->,red] (c)--++(-50.2:1.3) node[above right,black] {\Huge$\dd$};
      \draw[ultra thick,->,red] (c)--++(39.8:1.3) node[above right,black] {\Huge$\nn$};
      \draw[dashed,ultra thick,red](0,6)--(7.5,6);
      \draw[dashed,ultra thick,red](0,6)--++(-10.2:7.5);
      \draw[red,ultra thick] (7.2,6) arc (0:-10.2:7.2);

    \end{scope}

    \begin{scope}[shift={(0.5,0)}]
      \path[fill=gray0] (0,0) -- (5,0) -- (5,6) -- (0,6) -- cycle;
      \path[fill=gray1] (0,0) -- (5,0) -- (5,2.4) -- (6,2.4) -- (6,3.6)--(7,3.6)--(7,6)--(2,6)--(2,3.6)--(1,3.6)--(1,2.4)--(0,2.4)--cycle;

      \draw[gray2] (0,0) -- (0,6);
      \draw[gray2] (1,0) -- (1,6);
      \draw[gray2] (2,0) -- (2,6);
      \draw[gray2] (0,3.6) -- (5,3.6);
      \draw[gray2] (0,4.8) -- (5,4.8);
      \draw[gray2] (0,6) -- (5,6);


      \draw (0,0) -- (5,0);
      \draw (0,1.2) -- (5,1.2);
      \draw (0,2.4) -- (6,2.4);
      \draw(1,3.6) -- (7,3.6);
      \draw (2,4.8) -- (7,4.8);
      \draw (2,6) -- (7,6);
      \draw (0,0) -- (0,2.4);
      \draw (1,0) -- (1,3.6);
      \draw (2,0) -- (2,6);
      \draw (3,0) -- (3,6);
      \draw (4,0) -- (4,6);
      \draw (5,0) -- (5,6);
      \draw (6,2.4) -- (6,6);
      \draw (7,3.6) -- (7,6);

      \draw[->,red,dashed,ultra thick] (0,3.6) --++ (1,0);
      \draw[->,red,dashed,ultra thick] (0,4.8) --++ (2,0);
      \draw[->,red,dashed,ultra thick] (0,6) --++ (2,0);
      \draw[dashed,thick] (-1.2,2.4) -- (7.8,2.4); 
      \draw[ultra thick,red,->] (2.7,2.4) --++ (1.3,0) node[above right,black]{\Huge $\dd$};
      \draw[ultra thick,red,->] (2.7,2.4) --++ (0,1.3) node[above,black]{\Huge $\nn$};
      \draw[dashed, ultra thick,red] (5,0)--(7,6)--(7,0);
      \draw[red,ultra thick] (7,0.2) arc (270:251.57:5.8);
    \end{scope}

    \begin{scope}[shift={(3.2,-9)}] 
      \path[fill=gray1] (0,0) coordinate(a) --++ (5,0) coordinate(b) --++ (-10.4:6) coordinate(c) --++ (0,6) coordinate(d) --++ (-5,0) coordinate(e) --++(169.6:6) coordinate(f) --cycle;

      \foreach \x in {0,...,5}{
        \draw (\x,0) -- (\x,6-1.2*\x) ;
        \draw (0,1.2*\x) -- (5-\x,1.2*\x); 
        \draw (5-\x,1.2*\x) --++ (79.4:5-\x); 
        \draw (\x,6-1.2*\x) --++ (-10.4:6) coordinate (cc) --+ (5-\x,0);
        \draw (cc) --+ (0,1.2*\x);
        \path (f)--(b) coordinate[pos=-0.1](aa) coordinate[pos=1.1](bb);
        \draw[dashed,thick] (aa)--(bb); 
        \path (e)--(c) coordinate[pos=-0.1](aa) coordinate[pos=1.1](bb);
        \draw[dashed,thick] (aa)--(bb); 
      }
      \foreach \x in {1,...,5}{
        \path (\x,6-1.2*\x) --++ (-10.4:6) coordinate (cc);
        \draw (cc) --+ (259.6:5-\x);
      }

      \node at (1.5,1.9){\huge $\MM_{\alpha}^{0}$};
      \draw[ultra thick,red,->](0.7,1.2)--++(1.3,0);
      \draw[ultra thick,red,->](0.7,1.2)--++(0,1.3);

      \node at (5,3.5){\huge $\MM_{\alpha}^{\beta}$};
      \path (b)--(e) coordinate[pos=0.55](aa);
      \draw[ultra thick,red,->](aa)--++(79.6:1.3);
      \draw[ultra thick,red,->](aa)--++(169.6:1.3);
      
    \end{scope}


  \end{tikzpicture}
\end{document}